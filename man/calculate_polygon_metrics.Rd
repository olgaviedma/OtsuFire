% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/3.calculate_polygon_metrics.R
\name{calculate_polygon_metrics}
\alias{calculate_polygon_metrics}
\title{Calculate Geometric Metrics and Filter Fire Polygons (Batch Mode)}
\usage{
calculate_polygon_metrics(
  shapefile_paths,
  output_dir = NULL,
  area_min_ha = 10,
  bbox_h_min = 630,
  mnbbx_wd_min = 800,
  p_w_ratio_min = 4,
  h_w_ratio_min = 0.35
)
}
\arguments{
\item{shapefile_paths}{Character vector of paths to input polygon shapefiles.}

\item{output_dir}{Directory to save the output shapefiles. If `NULL`, outputs are saved next to input files.}

\item{area_min_ha}{Minimum area in hectares (`area_ha`). Set to `NULL` to disable. Default: 10.}

\item{bbox_h_min}{Minimum height of axis-aligned bounding box (`bbox_hy`). Default: 630.}

\item{mnbbx_wd_min}{Minimum width of rotated bounding box (`mnbbx_wd`). Default: 800.}

\item{p_w_ratio_min}{Minimum perimeter-to-width ratio (`p_w_ratio`). Default: 4.0.}

\item{h_w_ratio_min}{Minimum height-to-width ratio (`h_w_ratio`). Default: 0.35.}
}
\value{
A named list with one entry per input shapefile. Each entry contains:
\describe{
  \item{metrics}{Path to shapefile with all polygons and computed metrics.}
  \item{filtered}{Path to shapefile with only filtered polygons.}
  \item{polygons_all}{`sf` object with all input polygons and metrics.}
  \item{polygons_filtered}{`sf` object with only polygons that passed filters.}
}
}
\description{
This function calculates geometric descriptors for fire-affected polygons from
a list of input shapefiles. Metrics include area, perimeter, bounding box dimensions,
and elongation. Optionally, spatial filters can be applied to retain only polygons
that meet certain geometric criteria.
}
\details{
For each input shapefile, the function saves:
- A shapefile with all polygons and computed metrics.
- A filtered shapefile with only polygons passing all active filters.

If the input polygons contain a `CORINE_CLA` column, geometries are dissolved before metrics are calculated.

## Metrics calculated per polygon:
- `area_ha`: Area in hectares.
- `bbox_wx`: Width of the axis-aligned bounding box (east–west).
- `bbox_hy`: Height of the axis-aligned bounding box (north–south).
- `perim_m`: Polygon perimeter in meters.
- `p_w_ratio`: Perimeter-to-width ratio (`perim_m / bbox_wx`), proxy for complexity.
- `h_w_ratio`: Height-to-width ratio (`bbox_hy / bbox_wx`), proxy for anisotropy.
- `mnbbx_wd`: Width of the minimum rotated bounding box.
- `mnbbx_ln`: Length of the minimum rotated bounding box.
- `mnbbx_el`: Elongation as length-to-width ratio (`mnbbx_ln / mnbbx_wd`).

## Filtering behavior:
All filter thresholds are optional. If a parameter is `NULL`, its corresponding filter is skipped.
A polygon must satisfy **all active filters** to appear in the filtered output.
}
\examples{
\dontrun{
# Load example fire polygons and apply geometric filtering
burned_dir <- system.file("extdata", package = "OtsuFire")
burned_files <- list.files(
  burned_dir, pattern = glob2rx("burned_areas_*.shp$"), full.names = TRUE
)

# Define filtering thresholds
result_list <- calculate_polygon_metrics(
  shapefile_paths = burned_files,
  output_dir = burned_dir,
  area_min_ha = 10,
  bbox_h_min = 630,
  mnbbx_wd_min = 800,
  p_w_ratio_min = 4.0,
  h_w_ratio_min = 0.35
)

# Access paths and results
print(result_list[[1]]$filtered)
}

}
